{"version":3,"sources":["../../../src/plugins/stub/router.js"],"names":["path","require","baseRouter","PLUGIN_NAME","HANDLER_NAME_FIELD","module","exports","router","handlerParser","initGetList","req","res","stubList","getHandlerListByPlugin","jsonp","initGetOne","result","getHandler","params","_localPath","join","basePath","name","initPostOne","updateHandler","body","initGetOneReadMe","html","getReadMeContent"],"mappings":";;AAAA,IAAMA,OAAOC,QAAQ,MAAR,CAAb;AACA,IAAMC,aAAaD,QAAQ,yCAAR,CAAnB;;AAEA,IAAME,cAAc,MAApB;AACA,IAAMC,qBAAqB,UAA3B;;AAEAC,OAAOC,OAAP,GAAiB,UAACC,MAAD,EAASC,aAAT,EAA2B;;AAE1C;AACAN,aAAWO,WAAX,CAAuBF,MAAvB,EAA+BJ,WAA/B,EAA4C,UAACO,GAAD,EAAMC,GAAN,EAAc;AACxD,QAAIC,WAAWJ,cAAcK,sBAAd,CAAqCV,WAArC,CAAf;;AAEAQ,QAAIG,KAAJ,CAAUF,QAAV;AACD,GAJD;;AAMA;AACAV,aAAWa,UAAX,CAAsBR,MAAtB,EAA8BJ,WAA9B,EAA2CC,kBAA3C,EAA+D,UAACM,GAAD,EAAMC,GAAN,EAAc;AAC3E,QAAIK,SAASR,cAAcS,UAAd,CAAyBP,IAAIQ,MAAJ,CAAWd,kBAAX,CAAzB,CAAb;;AAEA;AACA,QAAIY,MAAJ,EAAY;AACVA,aAAOG,UAAP,GAAoBnB,KAAKoB,IAAL,CAAUZ,cAAca,QAAxB,EAAkCL,OAAOM,IAAzC,CAApB;AACD;;AAEDX,QAAIG,KAAJ,CAAUE,MAAV;AACD,GATD;;AAWA;AACAd,aAAWqB,WAAX,CAAuBhB,MAAvB,EAA+BJ,WAA/B,EAA4CC,kBAA5C,EAAgE,UAACM,GAAD,EAAMC,GAAN,EAAc;AAC5E,QAAIK,SAASR,cAAcgB,aAAd,CAA4Bd,IAAIQ,MAAJ,CAAWd,kBAAX,CAA5B,EAA4DM,IAAIe,IAAhE,CAAb;;AAEAd,QAAIG,KAAJ,CAAUE,MAAV;AACD,GAJD;;AAMA;AACAd,aAAWwB,gBAAX,CAA4BnB,MAA5B,EAAoCJ,WAApC,EAAiDC,kBAAjD,EAAqE,UAACM,GAAD,EAAMC,GAAN,EAAc;AACjFA,QAAIG,KAAJ,CAAU;AACRa,YAAMnB,cAAcoB,gBAAd,CAA+BlB,IAAIQ,MAAJ,CAAWd,kBAAX,CAA/B;AADE,KAAV;AAGD,GAJD;AAMD,CAnCD","file":"router.js","sourcesContent":["const path = require('path');\nconst baseRouter = require('../../server/router-handler/base-router');\n\nconst PLUGIN_NAME = 'stub';\nconst HANDLER_NAME_FIELD = 'stubName';\n\nmodule.exports = (router, handlerParser) => {\n\n  // GET /sys-cgi/stub 所有的 stub 列表信息\n  baseRouter.initGetList(router, PLUGIN_NAME, (req, res) => {\n    let stubList = handlerParser.getHandlerListByPlugin(PLUGIN_NAME);\n\n    res.jsonp(stubList);\n  });\n\n  // GET /sys-cgi/stub/:stubName 获得这个 stub 的信息\n  baseRouter.initGetOne(router, PLUGIN_NAME, HANDLER_NAME_FIELD, (req, res) => {\n    let result = handlerParser.getHandler(req.params[HANDLER_NAME_FIELD]);\n\n    // 附加一下本地的路径\n    if (result) {\n      result._localPath = path.join(handlerParser.basePath, result.name);\n    }\n\n    res.jsonp(result);\n  });\n\n  // POST /sys-cgi/stub/:stubName 设置这个 stub 的信息\n  baseRouter.initPostOne(router, PLUGIN_NAME, HANDLER_NAME_FIELD, (req, res) => {\n    let result = handlerParser.updateHandler(req.params[HANDLER_NAME_FIELD], req.body);\n\n    res.jsonp(result);\n  });\n\n  // GET /sys-cgi/stub/:stubName/readme 获得这个 stub 的 readme 信息\n  baseRouter.initGetOneReadMe(router, PLUGIN_NAME, HANDLER_NAME_FIELD, (req, res) => {\n    res.jsonp({\n      html: handlerParser.getReadMeContent(req.params[HANDLER_NAME_FIELD])\n    });\n  });\n\n};\n"]}