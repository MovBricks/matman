{"version":3,"sources":["../../src/util/url.js"],"names":["query","name","url","location","search","value","match","RegExp","decodeURIComponent","$2","replace","param","obj","str","k","hasOwnProperty","v","push","encodeURIComponent","join","param2","module","exports","p","_matman","_m_name","_m_target","_m_disable","console","log"],"mappings":";;;;;;;;AAAA;;;;;;AAMA,SAASA,KAAT,CAAeC,IAAf,EAAqBC,GAArB,EAA0B;AACxB,MAAI,CAACA,GAAL,EAAU;AACR,QAAI,OAAOC,QAAP,KAAoB,WAApB,IAAmC,CAACA,SAASC,MAAjD,EAAyD;AACvD,aAAO,EAAP;AACD;;AAEDF,UAAMC,SAASC,MAAf;AACD;;AAED,MAAIC,QAAQH,IACTI,KADS,CACH,IAAIC,MAAJ,CAAW,aAAaN,IAAb,GAAoB,eAA/B,CADG,IAERO,mBAAmBD,OAAOE,EAA1B,CAFQ,GAEwB,EAFpC;;AAIA,MAAIJ,MAAMC,KAAN,CAAY,cAAZ,CAAJ,EAAiC;AAC/B;AACAD,YAAQA,MAAMK,OAAN,CAAc,eAAd,EAA+B,EAA/B,CAAR;AACD;;AAED,SAAOL,KAAP;AACD;;AAED;;;;;;AAMA,SAASM,KAAT,GAAyB;AAAA,MAAVC,GAAU,uEAAJ,EAAI;;AACvB,MAAIC,MAAM,EAAV;;AAEA,OAAK,IAAIC,CAAT,IAAcF,GAAd,EAAmB;AACjB,QAAIA,IAAIG,cAAJ,CAAmBD,CAAnB,CAAJ,EAA2B;AACzB,UAAIE,IAAI,OAAOJ,IAAIE,CAAJ,CAAP,KAAkB,WAAlB,GAAgCF,IAAIE,CAAJ,CAAhC,GAAyC,EAAjD;AACAD,UAAII,IAAJ,CAASC,mBAAmBJ,CAAnB,IAAwB,GAAxB,GAA8BI,mBAAmBF,CAAnB,CAAvC;AACD;AACF;;AAED,SAAOH,IAAIM,IAAJ,CAAS,GAAT,CAAP;AACD;;AAED,SAASC,MAAT,GAA0B;AAAA,MAAVR,GAAU,uEAAJ,EAAI;;AACxB,MAAIC,MAAM,EAAV;;AAEA,OAAK,IAAIC,CAAT,IAAcF,GAAd,EAAmB;AACjB,QAAIA,IAAIG,cAAJ,CAAmBD,CAAnB,CAAJ,EAA2B;AACzB,UAAIE,IAAI,OAAOJ,IAAIE,CAAJ,CAAP,KAAkB,WAAlB,GAAgCF,IAAIE,CAAJ,CAAhC,GAAyC,EAAjD;AACAD,UAAII,IAAJ,CAASC,mBAAmBJ,CAAnB,IAAwB,GAAxB,GAA8BI,mBAAmB,yBAAeF,CAAf,CAAnB,CAAvC;AACD;AACF;;AAED,SAAOH,IAAIM,IAAJ,CAAS,GAAT,CAAP;AACD;;AAEDE,OAAOC,OAAP,GAAiB;AACftB,SAAOA,KADQ;AAEfW,SAAOA;AAFQ,CAAjB;;AAKA,IAAIY,IAAIH,OAAO;AACbI,WAAS,CAAC;AACRC,aAAS,aADD;AAERC,eAAW,SAFH;AAGRC,gBAAY;AAHJ,GAAD,EAIN;AACDF,aAAS,cADR;AAEDC,eAAW,MAFV;AAGDC,gBAAY;AAHX,GAJM;AADI,CAAP,CAAR;;AAYAC,QAAQC,GAAR,CAAYN,CAAZ;;AAEAK,QAAQC,GAAR,CAAY,CAAZ,EAAc7B,MAAM,SAAN,EAAiBuB,CAAjB,CAAd;AACAK,QAAQC,GAAR,CAAY,CAAZ,EAAc7B,MAAM,WAAN,EAAmB,mBAAnB,CAAd;AACA4B,QAAQC,GAAR,CAAY,CAAZ,EAAc7B,MAAM,WAAN,EAAmB,iEAAnB,CAAd;;AAEA4B,QAAQC,GAAR,CAAYrB,mBAAmBe,CAAnB,CAAZ","file":"url.js","sourcesContent":["/**\n * 获取查询参数\n * @param {String} name 查询参数\n * @param {String} [url] 链接地址\n * @return {String}\n */\nfunction query(name, url) {\n  if (!url) {\n    if (typeof location === 'undefined' || !location.search) {\n      return '';\n    }\n\n    url = location.search;\n  }\n\n  let value = url\n    .match(new RegExp('(\\\\??|&)' + name + '=([^&]*)(&|$)'))\n    ? decodeURIComponent(RegExp.$2) : '';\n\n  if (value.match(/<\\/?script>/i)) {\n    // 自动去除特殊标签，避免 xss 共计\n    value = value.replace(/<\\/?script>/ig, '');\n  }\n\n  return value;\n}\n\n/**\n * 按照key/value对序列化普通对象。注意此处只支持浅层序列化，\n * 即 obj 字段的值不能够为对象，例如 {a:1,b:{c:1}} 就不行，但 {a:1,c:1} 就可以\n * @param {Object} obj\n * @return {String}\n */\nfunction param(obj = {}) {\n  var str = [];\n\n  for (var k in obj) {\n    if (obj.hasOwnProperty(k)) {\n      var v = typeof obj[k] !== 'undefined' ? obj[k] : '';\n      str.push(encodeURIComponent(k) + '=' + encodeURIComponent(v));\n    }\n  }\n\n  return str.join('&');\n}\n\nfunction param2(obj = {}) {\n  var str = [];\n\n  for (var k in obj) {\n    if (obj.hasOwnProperty(k)) {\n      var v = typeof obj[k] !== 'undefined' ? obj[k] : '';\n      str.push(encodeURIComponent(k) + '=' + encodeURIComponent(JSON.stringify(v)));\n    }\n  }\n\n  return str.join('&');\n}\n\nmodule.exports = {\n  query: query,\n  param: param\n};\n\nlet p = param2({\n  _matman: [{\n    _m_name: 'demo_simple',\n    _m_target: 'success',\n    _m_disable: 0\n  }, {\n    _m_name: 'demo_simple2',\n    _m_target: 'fail',\n    _m_disable: 1\n  }]\n});\n\nconsole.log(p);\n\nconsole.log(1,query('_matman', p));\nconsole.log(2,query('_m_target', '_m_target=success'));\nconsole.log(3,query('_m_target', 'http://localhost:3000/cgi-bin/a/b/demo_simple?_m_target=success'));\n\nconsole.log(decodeURIComponent(p));"]}