{"version":3,"sources":["../../src/server/logger.js"],"names":["path","require","log4js","exports","init","logPath","isAbsolute","configure","appenders","type","filename","join","maxLogSize","category","absolute","replaceConsole","connectLogger","logger","level","name","getLogger","setLevel","matmanLog"],"mappings":";;AAAA,IAAMA,OAAOC,QAAQ,MAAR,CAAb;AACA,IAAMC,SAASD,QAAQ,QAAR,CAAf;;AAEAE,QAAQC,IAAR,GAAe,UAAUC,OAAV,EAAmB;AAChC,MAAIC,aAAaD,WAAWL,KAAKM,UAAL,CAAgBD,OAAhB,CAA5B;;AAEAH,SAAOK,SAAP,CAAiB;AACfC,eAAW,CACT,EAAEC,MAAM,SAAR,EADS,EACY;AACrB;AACEA,YAAM,MADR,EACgB;AACdC,gBAAUJ,aAAaN,KAAKW,IAAL,CAAUN,OAAV,EAAmB,YAAnB,CAAb,GAAgD,iBAF5D;AAGEO,kBAAY,OAAO,IAAP,GAAc,EAH5B,EAGgC;AAC9B;AACAC,gBAAU,MALZ;AAMEC,gBAAUR;AANZ,KAFS,EAUT;AACEG,YAAM,MADR,EACgB;AACdC,gBAAUJ,aAAaN,KAAKW,IAAL,CAAUN,OAAV,EAAmB,YAAnB,CAAb,GAAgD,iBAF5D;AAGEO,kBAAY,OAAO,IAAP,GAAc,EAH5B,EAGgC;AAC9B;AACAC,gBAAU,QALZ;AAMEC,gBAAUR;AANZ,KAVS,CADI;AAoBfS,oBAAgB;AApBD,GAAjB;AAsBD,CAzBD;;AA2BAZ,QAAQa,aAAR,GAAwB,YAAY;AAClC;AACA;AACA,SAAOd,OAAOc,aAAP,CAAqB,KAAKC,MAAL,CAAY,MAAZ,CAArB,EAA0C,EAAEC,OAAO,MAAT,EAA1C,CAAP;AACD,CAJD;;AAMAf,QAAQc,MAAR,GAAiB,UAAUE,IAAV,EAAgB;AAC/B,MAAMF,SAASf,OAAOkB,SAAP,CAAiBD,IAAjB,CAAf;;AAEAF,SAAOI,QAAP,CAAgB,MAAhB;;AAEA,SAAOJ,MAAP;AACD,CAND;;AAQAd,QAAQmB,SAAR,GAAoB,YAAY;AAC9B,SAAO,KAAKL,MAAL,CAAY,QAAZ,CAAP;AACD,CAFD","file":"logger.js","sourcesContent":["const path = require('path');\nconst log4js = require('log4js');\n\nexports.init = function (logPath) {\n  let isAbsolute = logPath && path.isAbsolute(logPath);\n\n  log4js.configure({\n    appenders: [\n      { type: 'console' }, //控制台输出\n      {\n        type: 'file', //文件输出\n        filename: isAbsolute ? path.join(logPath, 'access.log') : 'logs/access.log',\n        maxLogSize: 1024 * 1024 * 50, // 50MB\n        // backups: 1,\n        category: 'http',\n        absolute: isAbsolute\n      },\n      {\n        type: 'file', //文件输出\n        filename: isAbsolute ? path.join(logPath, 'matman.log') : 'logs/matman.log',\n        maxLogSize: 1024 * 1024 * 50, // 50MB\n        // backups: 1,\n        category: 'matman',\n        absolute: isAbsolute\n      }\n    ],\n    replaceConsole: true\n  });\n};\n\nexports.connectLogger = function () {\n  // return log4js.connectLogger(this.logger('http'), { level: 'auto', format: ':method :url' });\n  // https://github.com/nomiddlename/log4js-example/blob/master/app.js\n  return log4js.connectLogger(this.logger('http'), { level: 'auto' });\n};\n\nexports.logger = function (name) {\n  const logger = log4js.getLogger(name);\n\n  logger.setLevel('INFO');\n\n  return logger;\n};\n\nexports.matmanLog = function () {\n  return this.logger('matman');\n};\n"]}