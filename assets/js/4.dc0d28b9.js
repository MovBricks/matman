(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{353:function(t,s,a){t.exports=a.p+"assets/img/baidu_02_01.8706aa1f.jpg"},354:function(t,s,a){t.exports=a.p+"assets/img/baidu_02_02.df1dabdb.jpg"},355:function(t,s,a){t.exports=a.p+"assets/img/baidu_02_search-check_1.e851a79c.jpg"},356:function(t,s,a){t.exports=a.p+"assets/img/baidu_02_search-check_2.a7f973af.jpg"},357:function(t,s,a){t.exports=a.p+"assets/img/baidu_02_search-check_3.6099294a.jpg"},371:function(t,s,a){"use strict";a.r(s);var n=a(44),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"_02-测试用户交互"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_02-测试用户交互"}},[t._v("#")]),t._v(" 02. 测试用户交互")]),t._v(" "),n("p",[t._v("本节我们将实现：在 "),n("a",{attrs:{href:"https://www.baidu.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.baidu.com"),n("OutboundLink")],1),t._v(" 中输入 "),n("code",[t._v("matman")]),t._v(" 搜索，并且验证搜索结果。")]),t._v(" "),n("blockquote",[n("p",[t._v("最终的代码参考： "),n("a",{attrs:{href:"https://github.com/matmanjs/matman-demo-getting-started/tree/master/baidu_02",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/matmanjs/matman-demo-getting-started/tree/master/baidu_02"),n("OutboundLink")],1)])]),t._v(" "),n("h2",{attrs:{id:"_1-创建项目-baidu-02"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建项目-baidu-02"}},[t._v("#")]),t._v(" 1. 创建项目 baidu_02")]),t._v(" "),n("p",[t._v("为了简化，我们在 "),n("RouterLink",{attrs:{to:"/wiki/getting-started/baidu_01.html"}},[t._v("01. 第一个端对端测试")]),t._v(" 基础上继续进行，复制 "),n("code",[t._v("baidu_01")]),t._v(" 目录，并命名为 "),n("code",[t._v("baidu_02")]),t._v("，安装依赖。")],1),t._v(" "),n("h2",{attrs:{id:"_2-编写端对端测试模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-编写端对端测试模块"}},[t._v("#")]),t._v(" 2. 编写端对端测试模块")]),t._v(" "),n("p",[t._v('对于测试"用户交互"的场景，我们的基础理论为：')]),t._v(" "),n("ul",[n("li",[t._v("测试方案：通过对比动作前后的两个快照变化，如果变化是符合预期的，则说明该次动作的端对端测试通过")]),t._v(" "),n("li",[t._v("处理策略：但由于 "),n("RouterLink",{attrs:{to:"/wiki/basic-concepts/page-snapshot.html"}},[t._v("页面快照")]),t._v(" 是抽象的，无法进行比对，因此，我们做 web 端对端测试的时候，通过数据快照爬虫脚本将其转为 "),n("RouterLink",{attrs:{to:"/wiki/basic-concepts/data-snapshot.html"}},[t._v("数据快照")]),t._v(" 。")],1)]),t._v(" "),n("p",[t._v("就本 demo 而言，一共将发生三个动作，依次是：")]),t._v(" "),n("ul",[n("li",[t._v("第一步：加载 "),n("a",{attrs:{href:"https://www.baidu.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.baidu.com"),n("OutboundLink")],1),t._v(" 页面")]),t._v(" "),n("li",[t._v("第二步：在搜索框内输入 "),n("code",[t._v("matman")])]),t._v(" "),n("li",[t._v("第三步：点击搜索按钮")])]),t._v(" "),n("p",[t._v("每一个动作都会带来一定的变化，我们将其称之为一个新的 "),n("RouterLink",{attrs:{to:"/wiki/basic-concepts/page-snapshot.html"}},[t._v("页面快照")]),t._v("。为了区分不同阶段的快照，我们可以为快照命名：")],1),t._v(" "),n("ul",[n("li",[t._v("第一步：加载页面之后，产生的快照命名为 "),n("code",[t._v("init")])]),t._v(" "),n("li",[t._v("第二步：在输入框内输入 "),n("code",[t._v("matman")]),t._v(" 之后，产生的快照命名为 "),n("code",[t._v("input_key_word")])]),t._v(" "),n("li",[t._v("第三步：点击搜索按钮之后，产生的快照命名为 "),n("code",[t._v("click_to_search")])])]),t._v(" "),n("p",[n("img",{attrs:{src:a(353),alt:""}})]),t._v(" "),n("p",[t._v("完成之后的目录结构如下：")]),t._v(" "),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v(".\n├── matman.config.js\n├── package.json\n└── src\n    └── page_baidu_index\n        ├── cases\n        │   ├── basic-check\n        │   │   ├── index.js\n        │   │   └── index.test.js\n        │   └── search-check\n        │       ├── index.js\n        │       └── index.test.js\n        └── crawlers\n            ├── get-page-info-for-search.js\n            └── get-page-info.js\n")])])]),n("h3",{attrs:{id:"_2-1-编写数据快照爬虫脚本"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-编写数据快照爬虫脚本"}},[t._v("#")]),t._v(" 2.1 编写数据快照爬虫脚本")]),t._v(" "),n("p",[t._v("新增 "),n("code",[t._v("src/page_baidu_index/crawlers/get-page-info-for-search.js")]),t._v(" 文件。")]),t._v(" "),n("p",[t._v("每一次动作之后产生的信息是非常多的，大部分情况下我们不需要全部爬取出来，我们只需要选择我们关注的点即可，一般与要测试的目的有关系。例如，本次测试过程，我们就只选取了三个部分来验证功能。接下来我们简单介绍下为何这么选择：")]),t._v(" "),n("p",[t._v("第一部分：页面的 title 。我们发现在搜索之前 title 值为 "),n("code",[t._v("百度一下，你就知道")]),t._v("，而搜索之后，title 会变为 "),n("code",[t._v("matman_百度搜索")]),t._v(" 这种。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" title "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("第二部分：搜索框的信息。我们将输入 "),n("code",[t._v("matman")]),t._v(" 这个关键词，在页面加载完成时，显然输入框内容为空，输入关键词然后点击搜索按钮之后，输入框内都会保留这个 "),n("code",[t._v("matman")]),t._v("。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * 获取搜索框相关的信息\n */")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSearchInputInfo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        keyWorld"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#kw'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("val")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        searchBtnText"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#su'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("val")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("第三部分：搜索结果信息。显然这个不用解释，搜索之前一定没有搜索结果，而点击搜索按钮之后，预期能够获得搜索结果。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * 获取搜索结果相关的信息\n */")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSearchResultInfo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" jqContainer "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#content_left'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" result "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        isExist"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("jqContainer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        list"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getItemData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("jqItem")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            title"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.t'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" jqItem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("text")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("trim")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            describe"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.c-abstract'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" jqItem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("text")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("trim")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            tpl"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" jqItem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("attr")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'tpl'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.c-container'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" jqContainer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("each")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("list"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getItemData")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("编写完成之后，我们可以在浏览器内进行验证，执行爬虫脚本的打包命令：")]),t._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build-dev\n")])])]),n("p",[t._v("上述命令会生成一个调试脚本 "),n("code",[t._v("build/crawler-script_dev/page_baidu_index/crawlers/get-page-info-for-search.js")]),t._v(" ，拷贝所有的内容在浏览器 "),n("code",[t._v("console")]),t._v(" 控制台，然后查看输出即可。")]),t._v(" "),n("blockquote",[n("p",[t._v("编写爬虫脚本的过程，就是梳理业务的过程。爬取什么样的内容完全依据你的业务逻辑。")])]),t._v(" "),n("h3",{attrs:{id:"_2-2-编写测试行为模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-编写测试行为模块"}},[t._v("#")]),t._v(" 2.2 编写测试行为模块")]),t._v(" "),n("p",[t._v("新增 "),n("code",[t._v("src/page_baidu_index/cases/search-check/index.js")]),t._v(" 文件。")]),t._v(" "),n("p",[t._v("本次测试过程涉及了三个动作，因此两个 case 中 "),n("a",{attrs:{href:"https://github.com/matmanjs/matman-demo-getting-started/blob/master/baidu_02/src/page_baidu_index/cases/search-check/index.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("search-check"),n("OutboundLink")],1),t._v(" 与 "),n("a",{attrs:{href:"https://github.com/matmanjs/matman-demo-getting-started/blob/master/baidu_01/src/page_baidu_index/cases/basic-check/index.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("basic-check"),n("OutboundLink")],1),t._v(" 的执行脚本是有区别的：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 5. 执行并返回 Promise 结果")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" caseParser"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleOperate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pageUrl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" crawlerScriptPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reqOpts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("testAction")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第一步：开始操作之前")]),t._v("\n        testAction"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAction")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'init'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("nightmareRun")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" nightmareRun"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("wait")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第二步：搜索输入框输入: matman")]),t._v("\n        testAction"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAction")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'input_key_word'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("nightmareRun")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" nightmareRun"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#kw'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'matman'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("wait")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第三步：点击搜索按钮，获得搜索结果")]),t._v("\n        testAction"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAction")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click_to_search'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("nightmareRun")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" nightmareRun"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("click")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#su'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("wait")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#content_left'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_2-3-编写测试用例脚本"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-编写测试用例脚本"}},[t._v("#")]),t._v(" 2.3 编写测试用例脚本")]),t._v(" "),n("p",[t._v("新增 "),n("code",[t._v("src/page_baidu_index/cases/search-check/index.test.js")]),t._v(" 文件。")]),t._v(" "),n("p",[t._v("两个 case 中 "),n("a",{attrs:{href:"https://github.com/matmanjs/matman-demo-getting-started/blob/master/baidu_02/src/page_baidu_index/cases/search-check/index.test.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("search-check"),n("OutboundLink")],1),t._v(" 与 "),n("a",{attrs:{href:"https://github.com/matmanjs/matman-demo-getting-started/blob/master/baidu_01/src/page_baidu_index/cases/basic-check/index.test.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("basic-check"),n("OutboundLink")],1),t._v(" 的测试脚本也是有区别的。具体请查看 "),n("a",{attrs:{href:"https://github.com/matmanjs/matman-demo-getting-started/blob/master/baidu_01/src/page_baidu_index/cases/basic-check/index.test.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("源码"),n("OutboundLink")],1),t._v(" 。")]),t._v(" "),n("p",[t._v("需要补充的是，此步骤是为了对比数据快照之间的区别，因此，每一个步骤执行之后验证的重点是不一样的，依据业务自身特点，至少要涵盖关键变化。例如第二步输入搜索词之后，需要关注输入框内是否真存在搜索词，而第三步点击搜索按钮之后，则重点看搜索结果是否存在，同时页面 title 也发生了变化。")]),t._v(" "),n("h3",{attrs:{id:"_2-4-执行端对端测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-执行端对端测试"}},[t._v("#")]),t._v(" 2.4 执行端对端测试")]),t._v(" "),n("p",[t._v("运行如下命令，执行端对端测试：")]),t._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("\n")])])]),n("p",[n("img",{attrs:{src:a(354),alt:""}})]),t._v(" "),n("p",[t._v("同时，由于我们配置了测试过程截图，因此可以在 "),n("code",[t._v("build/screenshot/page_baidu_index_cases")]),t._v(" 目录下看到截图：")]),t._v(" "),n("ul",[n("li",[t._v("第一步：加载页面")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(355),alt:""}})]),t._v(" "),n("ul",[n("li",[t._v("第二步：在输入框内输入 "),n("code",[t._v("matman")])])]),t._v(" "),n("p",[n("img",{attrs:{src:a(356),alt:""}})]),t._v(" "),n("ul",[n("li",[t._v("第三步：点击搜索按钮")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(357),alt:""}})])])}),[],!1,null,null,null);s.default=e.exports}}]);